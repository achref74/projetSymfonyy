
<style>
li {
    color: white;}
</style>
{{ form_start(form, {'attr': {'class': 'form-horizontal'}}) }}

    <div class="row mb-3 mx-3">
        <div class="col-4">
            {{ form_label(form.nom, 'Nom', {'label_attr': {'class': 'control-label text-white'}}) }}
            {{ form_widget(form.nom, {'attr': {'class': 'form-control'}}) }}
            {{ form_errors(form.nom, {'attr': {'class': 'alert alert-danger'}}) }}
        </div>

        <div class="col-4">
            {{ form_label(form.note, 'Note', {'label_attr': {'class': 'control-label text-white'}}) }}
            {{ form_widget(form.note, {'attr': {'class': 'form-control'}}) }}
          <div class="alert alert-danger"> {{ form_errors(form.note, {'attr': {'class': 'control-label text-white'}}) }}</div> 
        </div>

    </div>

    <h4 class="text-white">Questions : </h4>

    <div class="questions row"
        data-index="{{ form.questions|length > 0 ? (form.questions|last.vars.id|default(0)|number_format(0, '.', '')) + 1 : 0 }}"
        data-prototype="{{ form_widget(form.questions.vars.prototype)|e('html_attr') }}"
    ></div>

    <button type="button" class="btn btn-primary mx-2 add_item_link" data-collection-holder-class="questions">Add a Question</button>
    <button class="btn btn-success">{{ button_label|default('Save') }}</button>

{{ form_end(form) }}

<script>
document
  .querySelectorAll('.add_item_link')
  .forEach(btn => {
      btn.addEventListener("click", addFormToCollection)
  });

  document
    .querySelectorAll('div.questions div')
    .forEach((question) => {
        addTagFormDeleteLink(question)
    })

function addFormToCollection(e) {
       const collectionHolder = document.querySelector('.' + e.currentTarget.dataset.collectionHolderClass);

    const item = document.createElement('div');
    item.classList.add('col-4'); 

  item.innerHTML = collectionHolder
    .dataset
    .prototype
    .replace(
      /__name__/g,
      collectionHolder.dataset.index
    );

    collectionHolder.appendChild(item);

    collectionHolder.dataset.index++;

    addTagFormDeleteLink(item);
}


function addTagFormDeleteLink(item) {
    const removeFormButton = document.createElement('button');
    removeFormButton.innerText = 'Delete this question';
    removeFormButton.classList.add('btn', 'btn-danger', 'my-3','mx-3','w-20'); 

    item.append(removeFormButton);

    removeFormButton.addEventListener('click', (e) => {
        e.preventDefault();
        item.remove();
    });
}

</script>
